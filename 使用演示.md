# Photo Watermark 2 - 使用演示与快速开始

## 🚀 快速开始

### 运行程序

直接运行 PhotoWatermark2.exe

## 📖 基础使用教程

### 导入图片

有4种方式导入图片：

1. **拖拽导入** ⭐推荐
   - 直接将图片文件（单张/多张）拖到程序窗口

2. **选择单张**
   - 点击"选择单张"按钮
   - 选择一张图片

3. **批量选择**
   - 点击"批量选择"按钮
   - 一次性选择多张图片

4. **选择文件夹**
   - 点击"选择文件夹"按钮
   - 导入整个文件夹的所有图片

### 添加文本水印

1. 切换到**"文本水印"**标签页

2. 基础设置：
   - **水印文本**：输入要显示的文字
   - **字体**：选择字体（支持中英文）
   - **字体大小**：调整文字大小（文本框）
   - **颜色**：点击颜色框选择颜色，支持调色板

3. 样式设置：
   - ☑️ **粗体**：加粗文字
   - ☑️ **斜体**：倾斜文字
   - ☑️ **阴影**：添加阴影效果
   - ☑️ **描边**：添加描边效果

4. 通用设置：
   - **透明度**：0-100（100为不透明）
   - **旋转角度**：任意角度

5. 位置设置：
   - 选择九宫格位置，或
   - 选择"自定义（拖拽）"后直接在预览图上拖动水印

### 添加图片水印

1. 切换到**"图片水印"**标签页

2. 选择水印图片：
   - 点击"选择"按钮
   - 选择PNG图片（建议使用透明背景）

3. 调整设置：
   - **缩放比例**：百分比调整大小（10%-500%）
   - **透明度**：调整水印透明度
   - **旋转角度**：旋转水印

4. 位置设置：
   - 同文本水印，支持九宫格和拖拽

### 导出图片

1. 设置输出文件夹：
   - 点击"浏览"选择保存位置
   - ⚠️ 不建议选择原图片所在文件夹

2. 选择命名规则：
   - **原名**：保持原文件名
   - **前缀** ⭐推荐：添加前缀（默认：`wm_`）
   - **后缀**：添加后缀（默认：`_watermarked`）

3. 选择输出格式：
   - **JPEG**：可调整质量（0-100）
   - **PNG**

4. （可选）调整图片尺寸：
   - ☑️ **调整尺寸**
   - 选择按百分比或指定宽高
   - ☑️ **可选保持比例**

5. 导出：
   - **导出当前**：只导出当前查看的图片
   - **批量导出** ⭐推荐：导出所有已导入的图片

### 模板管理

#### 保存模板
1. 配置好水印设置后
2. 在"模板名称"输入框输入名称（如：`公司Logo`）
3. 点击"保存模板"
4. ✅ 模板已保存

#### 使用模板
1. 点击"模板"下拉框
2. 选择已保存的模板
3. 水印设置自动应用

#### 删除模板
1. 选择要删除的模板
2. 点击"删除模板"
3. 确认删除

### 快捷操作

#### 键盘快捷键
- **上/下方向键**：切换上一张/下一张图片（图片列表获得焦点时）

#### 鼠标操作
- **拖拽水印**：在预览图上直接拖动水印到想要的位置
- **滚轮滚动**：在水印设置面板使用鼠标滚轮上下滚动

---

## 🎯 完整工作流程

### 场景1：为照片添加版权水印

#### 步骤：

1. **启动程序**

   - 启动 PhotoWatermark2.exe

   - 或运行
      ```bash
      python main.py
      ```

2. **导入照片**
   - 拖拽照片到程序窗口，或
   - 点击"批量选择"按钮选择多张照片

3. **设置文本水印**
   - 水印类型：选择"文本水印"
   - 文本内容：输入"© 2024 Your Name"
   - 字体选择："微软雅黑"
   - 字体大小：80
   - 字体颜色：白色 (#FFFFFF)
   - 透明度：80%

4. **拖拽定位水印**
   - 在预览图上点击并拖拽水印
   - 移动到照片右下角合适位置
   - 位置会自动切换到"自定义（拖拽）"

5. **调整样式（可选）**
   - 勾选"阴影"增加可读性
   - 或勾选"描边"使水印更明显

6. **保存为模板**
   - 输入模板名称："版权水印"
   - 点击"保存模板"
   - 下次使用直接加载

7. **批量导出**
   - 选择输出文件夹
   - 选择命名规则："后缀"
   - 输入后缀："_copyright"
   - 输出格式：JPEG，质量：95
   - 点击"批量导出"

### 场景2：为产品图添加Logo水印

#### 步骤：

1. **导入产品图片**
   - 拖拽产品图片到程序窗口

2. **设置图片水印**
   - 水印类型：选择"图片水印"
   - 点击"选择"，选择Logo PNG文件
   - 缩放比例：20%（根据需要调整）
   - 透明度：90%

3. **拖拽定位Logo**
   - 在预览图上拖拽Logo到左上角
   - 确保不遮挡产品主体

4. **批量导出**
   - 选择输出文件夹
   - 命名规则："原名"
   - 输出格式：PNG（保留透明通道）
   - 点击"批量导出"

### 场景3：为内部文档添加"保密"水印

#### 步骤：

1. **导入文档截图**
   - 选择文件夹，导入所有截图

2. **设置保密水印**
   - 文本内容："内部资料·保密"
   - 字体："黑体"
   - 字体大小：48
   - 颜色：红色 (#FF0000)
   - 透明度：60%
   - 旋转角度：-30°（对角线）

3. **定位水印**
   - 方法1：选择"中心"位置
   - 方法2：拖拽到中心偏上位置

4. **保存模板**
   - 模板名称："保密水印"

5. **批量导出**
   - 输出格式：PNG
   - 命名：添加前缀"CONFIDENTIAL_"

## 💡 使用技巧

### 技巧1：精确字体调整

**问题**：找不到想要的字体效果

**方法**：
1. 在字体下拉框中选择不同字体
2. 实时预览效果
3. 中文水印推荐：微软雅黑（现代）、黑体（醒目）、楷体（优雅）
4. 英文水印推荐：Arial（简洁）、Times New Roman（正式）

### 技巧2：精确水印定位

**场景**：需要将水印放在特定位置

**方法**：
1. 先选择九宫格中最接近的位置
2. 切换到预览图
3. 按住鼠标左键拖拽微调
4. 观察实时预览效果
5. 释放鼠标固定位置

### 技巧3：批量处理相同水印

**场景**：100张照片需要加同样的水印

**方法**：
1. 用一张照片调试好所有参数
2. 拖拽定位到满意位置
3. 保存为模板（如"标准水印"）
4. 导入所有照片
5. 加载模板
6. 批量导出（程序会对每张图片应用相同位置）

### 技巧4：不同尺寸照片的水印

**问题**：照片尺寸不同，水印位置可能不理想

**建议**：
- **预设位置**：对不同尺寸图片效果较好（如右下角）
- **自定义位置**：适合尺寸相近的图片
- **建议做法**：按照片尺寸分组处理

### 技巧5：透明背景水印

**场景**：需要保留图片透明背景

**方法**：
1. 导入PNG透明图片
2. 添加水印
3. 输出格式选择：PNG
4. 导出后透明背景保持

### 技巧6：快速切换预览

**场景**：检查多张图片的水印效果

**方法**：
1. 使用"上一张"/"下一张"按钮
2. 或使用键盘上下方向键
3. 或直接点击图片列表
4. 每张图片都会显示相同的水印效果

### 技巧7：批量处理相同水印

**场景**：100张照片需要加同样的水印

**方法**：
1. 导入所有图片（文件夹导入最快）
2. 设置好水印样式
3. 选择输出文件夹
4. 点击"批量导出"
5. ☕ 等待处理完成

### 技巧8：制作透明Logo水印

**场景**：为产品图片添加品牌Logo

**方法**：
1. 准备PNG格式的透明Logo
2. 切换到"图片水印"标签页
3. 选择Logo文件
4. 调整缩放比例（建议0.3-0.8）
5. 调整透明度（建议50-80）
6. 选择合适位置（通常是右下角）

### 技巧9：保存常用水印模板

**方法**：
1. 公司Logo：保存为"公司标识"
2. 版权声明：保存为"版权文字"
3. 社交媒体：保存为"抖音水印"、"微博水印"等
4. 下次使用时直接选择模板即可

### 技巧10：防止覆盖原图

✅ **始终使用前缀或后缀命名**
- 默认前缀 `wm_` 已经很好用
- 或者选择一个专门的导出文件夹

❌ **不要使用"原名"并导出到原文件夹**
- 这样会覆盖原图！

## 🎨 参数示例

### 文本水印效果

**简洁版权**：
- 文本："© 2024"
- 字体：Arial
- 大小：24
- 颜色：白色
- 透明度：70%
- 位置：右下角

**醒目警告**：
- 文本："SAMPLE"
- 字体：Arial Bold
- 大小：72
- 颜色：红色
- 透明度：50%
- 旋转：-45°
- 位置：中心
- 描边：开启

**优雅签名**：
- 文本："摄影：张三"
- 字体：楷体
- 大小：28
- 颜色：黑色
- 透明度：90%
- 阴影：开启
- 位置：左下角

### Logo水印效果

**品牌标识**：
- 图片：透明PNG Logo
- 缩放：0.15
- 透明度：85%
- 位置：右上角

**大Logo居中**：
- 图片：品牌Logo
- 缩放：0.5
- 透明度：40%
- 位置：中心

## 📝 注意事项

### 字体相关

1. **字体可用性**：确保系统已安装所选字体
2. **中文字体**：Windows自带微软雅黑、宋体、黑体
3. **字体大小**：根据图片尺寸调整，通常48-96适中
4. **字体颜色**：与背景对比度要足够

### 图片水印相关

1. **图片水印大小**：根据图片尺寸调整，通常水印尺寸要远小于待添加水印的图像的尺寸。

### 位置定位

1. **拖拽精度**：慢慢拖拽获得更精确的位置
2. **批量一致性**：自定义位置对所有图片使用相同像素坐标
3. **预览确认**：导出前切换几张图片确认效果
4. **重新定位**：选择预设位置后可重新拖拽

### 导出设置

1. **输出文件夹**：建议新建文件夹，避免覆盖原图
2. **文件命名**：使用前缀或后缀区分
3. **格式选择**：照片用JPEG，需要透明用PNG
4. **质量设置**：JPEG质量建议90-95

## 🚀 高级应用

### 应用1：批量处理不同水印

为不同类别图片添加不同水印：

1. 创建多个模板（如"版权"、"草稿"、"样品"）
2. 分批导入不同类别图片
3. 分别加载对应模板
4. 分别导出到不同文件夹

### 应用2：组合水印

同时使用文本和图片水印：

1. 第一轮：添加Logo图片水印，导出
2. 第二轮：导入第一轮结果，添加文本水印，再导出

### 应用3：自动化工作流

建立标准化流程：

1. 为常用场景创建模板
2. 统一命名规则
3. 固定输出文件夹结构
4. 批量处理，快速完成

## ❓ 常见问题

### Q: 文本水印显示不完整？
**A**: 增大字体边距或减小字体大小。如果是旋转导致的，可以尝试减小旋转角度。

### Q: 图片水印不显示？
**A**: 
1. 确认已选择水印图片
2. 检查透明度是否为0（完全透明）
3. 检查缩放比例是否过小
4. 检查比例是否缩放过大，若水印图片的尺寸大于原图尺寸，那么图片水印会超出边界。

### Q: 批量导出很慢？
**A**: 这是正常的，大量图片处理需要时间。程序使用多线程处理，请耐心等待。不要关闭程序。

### Q: 中文字体不支持粗体/斜体？
**A**: 中文字体使用模拟粗体和斜体效果（绘制多层和仿射变换）。

### Q: 想要更多字体？
**A**: 当前只支持8种常用字体以确保跨系统兼容性。这些字体在大多数Windows系统上都可用。

### Q: 如何查看系统字体？
**A**: 
- 打开文件夹：`C:\Windows\Fonts`
- 或：控制面板 → 字体

### Q: 拖拽功能不可用？
**A**: 
1. 确认已安装 `tkinterdnd2` 库
2. 运行：`pip install tkinterdnd2`
3. 重新启动程序
4. 如果还不行，使用按钮导入方式

### Q: 导出的图片质量不好？
**A**: 
1. JPEG格式：提高质量滑块到90-95
2. 考虑使用PNG格式（无损）
3. 避免多次导出同一张图片

### Q: 水印位置在不同图片上不一致？
**A**: 
1. **九宫格位置**：对不同尺寸图片自动适配
2. **自定义拖拽**：使用像素坐标，适合相同尺寸图片
3. **建议**：相同尺寸的图片一起处理

### Q: 如何添加多个水印？
**A**: 
1. 第一轮：添加第一个水印并导出
2. 第二轮：导入第一轮结果，添加第二个水印
3. 重复以上步骤

## 📋 系统要求

- **操作系统**：Windows 10/11
- **Python版本**：3.7+
- **内存**：建议4GB以上
- **磁盘空间**：安装后约200MB

## 📚 获取帮助

- 查看 `功能清单.md` 了解所有功能和最新更新
- 查看 `使用演示.md` 了解详细使用说明
- 查看 `README.md` 了解架构设计和安装方法

---

## 🎉 开始使用

现在你已经掌握了 Photo Watermark 2 的完整使用方法！

启动程序，开始为你的图片添加专业水印吧！

启动 `PhotoWatermark2.exe`,

或运行
```bash
python main.py
```

